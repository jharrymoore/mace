2023-06-22 13:51:15.727 INFO: MACE version: 0.2.0
2023-06-22 13:51:15.728 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=8, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 13:51:15.838 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 13:51:23.738 INFO: Loaded 24051 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz'
2023-06-22 13:51:23.739 INFO: Using random 10.0% of training set for validation
2023-06-22 13:51:23.748 INFO: Total number of configurations: train=21646, valid=2405, tests=[]
2023-06-22 13:51:23.858 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 13:51:23.858 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 13:51:23.858 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 13:52:10.339 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 13:52:14.179 INFO: Average number of neighbors: 17.04974900616106
2023-06-22 13:52:14.179 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 13:52:14.179 INFO: Building model
2023-06-22 13:52:14.179 INFO: Hidden irreps: 96x0e
2023-06-22 13:52:23.170 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 13:52:23.244 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.202622, shift=-5.583288)
)
2023-06-22 13:52:23.249 INFO: Number of parameters: 386032
2023-06-22 13:52:23.250 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 13:52:23.250 INFO: Using Weights and Biases for logging
2023-06-22 13:53:37.572 INFO: MACE version: 0.2.0
2023-06-22 13:53:37.572 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=8, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 13:53:37.680 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 13:53:45.372 INFO: Loaded 24051 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz'
2023-06-22 13:53:45.373 INFO: Using random 10.0% of training set for validation
2023-06-22 13:53:45.382 INFO: Total number of configurations: train=21646, valid=2405, tests=[]
2023-06-22 13:53:45.489 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 13:53:45.489 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 13:53:45.489 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 13:54:31.830 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 13:54:35.668 INFO: Average number of neighbors: 17.04974900616106
2023-06-22 13:54:35.669 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 13:54:35.669 INFO: Building model
2023-06-22 13:54:35.669 INFO: Hidden irreps: 96x0e
2023-06-22 13:54:40.960 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 13:54:41.026 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.202622, shift=-5.583288)
)
2023-06-22 13:54:41.028 INFO: Number of parameters: 386032
2023-06-22 13:54:41.028 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 13:54:41.028 INFO: Using Weights and Biases for logging
2023-06-22 14:23:39.667 INFO: MACE version: 0.2.0
2023-06-22 14:23:39.692 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=8, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 14:23:39.820 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 14:23:47.598 INFO: Loaded 24051 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz'
2023-06-22 14:23:47.599 INFO: Using random 10.0% of training set for validation
2023-06-22 14:23:47.610 INFO: Total number of configurations: train=21646, valid=2405, tests=[]
2023-06-22 14:23:47.719 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 14:23:47.719 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 14:23:47.719 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 14:24:09.041 INFO: MACE version: 0.2.0
2023-06-22 14:24:09.042 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=128, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 14:24:09.153 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 14:24:16.867 INFO: Loaded 24051 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz'
2023-06-22 14:24:16.868 INFO: Using random 10.0% of training set for validation
2023-06-22 14:24:16.877 INFO: Total number of configurations: train=21646, valid=2405, tests=[]
2023-06-22 14:24:16.984 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 14:24:16.984 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 14:24:16.984 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 14:25:03.284 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 14:25:06.218 INFO: Average number of neighbors: 17.049769331497835
2023-06-22 14:25:06.218 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 14:25:06.218 INFO: Building model
2023-06-22 14:25:06.218 INFO: Hidden irreps: 96x0e
2023-06-22 14:25:14.116 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 14:25:14.192 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.202743, shift=-5.583158)
)
2023-06-22 14:25:14.198 INFO: Number of parameters: 386032
2023-06-22 14:25:14.198 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 14:25:14.198 INFO: Using Weights and Biases for logging
2023-06-22 14:25:53.008 INFO: MACE version: 0.2.0
2023-06-22 14:25:53.009 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=128, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 14:25:53.140 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 14:26:00.840 INFO: Loaded 24051 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz'
2023-06-22 14:26:00.841 INFO: Using random 10.0% of training set for validation
2023-06-22 14:26:00.851 INFO: Total number of configurations: train=21646, valid=2405, tests=[]
2023-06-22 14:26:00.963 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 14:26:00.963 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 14:26:00.963 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 14:26:47.723 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 14:26:50.637 INFO: Average number of neighbors: 17.049769331497835
2023-06-22 14:26:50.637 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 14:26:50.638 INFO: Building model
2023-06-22 14:26:50.638 INFO: Hidden irreps: 96x0e
2023-06-22 14:26:54.695 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 14:26:54.764 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.202743, shift=-5.583158)
)
2023-06-22 14:26:54.766 INFO: Number of parameters: 386032
2023-06-22 14:26:54.766 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 14:26:54.766 INFO: Using Weights and Biases for logging
2023-06-22 14:56:31.851 INFO: MACE version: 0.2.0
2023-06-22 14:56:31.852 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=128, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 14:56:31.980 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 14:56:39.186 INFO: Loaded 24051 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral.xyz'
2023-06-22 14:56:39.187 INFO: Using random 10.0% of training set for validation
2023-06-22 14:56:39.196 INFO: Total number of configurations: train=21646, valid=2405, tests=[]
2023-06-22 14:56:39.287 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 14:56:39.288 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 14:56:39.288 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 14:57:25.158 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 14:57:27.769 INFO: Average number of neighbors: 17.049769331497835
2023-06-22 14:57:27.769 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 14:57:27.770 INFO: Building model
2023-06-22 14:57:27.770 INFO: Hidden irreps: 96x0e
2023-06-22 14:57:35.293 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 14:57:35.373 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.202743, shift=-5.583158)
)
2023-06-22 14:57:35.379 INFO: Number of parameters: 386032
2023-06-22 14:57:35.379 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 14:57:35.379 INFO: Using Weights and Biases for logging
2023-06-22 14:57:41.691 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 14:57:41.692 INFO: Started training
2023-06-22 16:55:18.591 INFO: MACE version: 0.1.0
2023-06-22 16:55:18.607 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, test_dir=None, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, fine_tune=None, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 16:55:18.769 INFO: CUDA version: 11.2, CUDA device: 0
2023-06-22 16:55:18.856 INFO: Loaded 8 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 16:55:18.856 INFO: Using random 10.0% of training set for validation
2023-06-22 16:55:18.857 INFO: Total number of configurations: train=8, valid=0, tests=[]
2023-06-22 16:55:18.858 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 16:55:18.858 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 16:55:18.858 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 16:55:18.976 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 16:55:19.059 INFO: Average number of neighbors: 14.056818181818182
2023-06-22 16:55:19.059 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 16:55:19.059 INFO: Building model
2023-06-22 16:55:19.059 INFO: Hidden irreps: 96x0e
2023-06-22 16:55:28.143 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 16:55:28.202 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.230302, shift=-5.818402)
)
2023-06-22 16:55:28.209 INFO: Number of parameters: 386032
2023-06-22 16:55:28.209 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 16:55:28.209 INFO: Using Weights and Biases for logging
2023-06-22 16:55:40.383 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 16:55:40.383 INFO: Started training
2023-06-22 16:59:10.530 INFO: MACE version: 0.1.0
2023-06-22 16:59:10.531 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, test_dir=None, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, fine_tune=None, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 16:59:10.670 INFO: CUDA version: 11.2, CUDA device: 0
2023-06-22 16:59:10.700 INFO: Loaded 8 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 16:59:10.700 INFO: Using random 10.0% of training set for validation
2023-06-22 16:59:10.700 INFO: Total number of configurations: train=8, valid=0, tests=[]
2023-06-22 16:59:10.700 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 16:59:10.700 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 16:59:10.700 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 16:59:10.718 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 16:59:10.722 INFO: Average number of neighbors: 14.056818181818182
2023-06-22 16:59:10.722 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 16:59:10.722 INFO: Building model
2023-06-22 16:59:10.722 INFO: Hidden irreps: 96x0e
2023-06-22 16:59:12.401 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 16:59:12.458 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.230302, shift=-5.818402)
)
2023-06-22 16:59:12.460 INFO: Number of parameters: 386032
2023-06-22 16:59:12.460 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 16:59:12.460 INFO: Using Weights and Biases for logging
2023-06-22 16:59:20.715 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 16:59:20.716 INFO: Started training
2023-06-22 16:59:55.574 INFO: MACE version: 0.1.0
2023-06-22 16:59:55.575 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, test_dir=None, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, fine_tune=None, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 16:59:55.719 INFO: CUDA version: 11.2, CUDA device: 0
2023-06-22 16:59:55.746 INFO: Loaded 8 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 16:59:55.747 INFO: Using random 10.0% of training set for validation
2023-06-22 16:59:55.747 INFO: Total number of configurations: train=8, valid=0, tests=[]
2023-06-22 16:59:55.747 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 16:59:55.747 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 16:59:55.747 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 16:59:55.765 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 16:59:55.769 INFO: Average number of neighbors: 14.056818181818182
2023-06-22 16:59:55.769 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 16:59:55.769 INFO: Building model
2023-06-22 16:59:55.769 INFO: Hidden irreps: 96x0e
2023-06-22 16:59:57.442 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 16:59:57.499 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.230302, shift=-5.818402)
)
2023-06-22 16:59:57.500 INFO: Number of parameters: 386032
2023-06-22 16:59:57.501 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 16:59:57.501 INFO: Using Weights and Biases for logging
2023-06-22 17:00:05.576 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:00:05.577 INFO: Started training
2023-06-22 17:05:21.683 INFO: MACE version: 0.1.0
2023-06-22 17:05:21.684 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, test_dir=None, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, fine_tune=None, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:05:21.824 INFO: CUDA version: 11.2, CUDA device: 0
2023-06-22 17:05:21.854 INFO: Loaded 8 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:05:21.854 INFO: Using random 10.0% of training set for validation
2023-06-22 17:05:21.854 INFO: Total number of configurations: train=8, valid=0, tests=[]
2023-06-22 17:05:21.854 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:05:21.854 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:05:21.854 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:05:21.873 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:05:21.877 INFO: Average number of neighbors: 14.056818181818182
2023-06-22 17:05:21.877 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:05:21.877 INFO: Building model
2023-06-22 17:05:21.877 INFO: Hidden irreps: 96x0e
2023-06-22 17:05:23.551 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:05:23.607 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.230302, shift=-5.818402)
)
2023-06-22 17:05:23.609 INFO: Number of parameters: 386032
2023-06-22 17:05:23.609 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:05:23.609 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:05:23.609 INFO: Started training
2023-06-22 17:08:03.448 INFO: MACE version: 0.1.0
2023-06-22 17:08:03.448 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, test_dir=None, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, fine_tune=None, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:08:03.575 INFO: CUDA version: 11.2, CUDA device: 0
2023-06-22 17:08:03.605 INFO: Loaded 8 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:08:03.605 INFO: Using random 10.0% of training set for validation
2023-06-22 17:08:03.605 INFO: Total number of configurations: train=8, valid=0, tests=[]
2023-06-22 17:08:03.605 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:08:03.606 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:08:03.606 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:08:03.611 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:08:03.615 INFO: Average number of neighbors: 14.056818181818182
2023-06-22 17:08:03.615 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:08:03.615 INFO: Building model
2023-06-22 17:08:03.615 INFO: Hidden irreps: 96x0e
2023-06-22 17:08:05.292 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:08:05.349 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.230302, shift=-5.818402)
)
2023-06-22 17:08:05.351 INFO: Number of parameters: 386032
2023-06-22 17:08:05.351 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:08:05.351 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:08:05.351 INFO: Started training
2023-06-22 17:09:05.425 INFO: MACE version: 0.1.0
2023-06-22 17:09:05.425 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, test_dir=None, num_workers=0, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, fine_tune=None, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:09:05.550 INFO: CUDA version: 11.2, CUDA device: 0
2023-06-22 17:09:05.607 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:09:05.608 INFO: Using random 10.0% of training set for validation
2023-06-22 17:09:05.608 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:09:05.608 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:09:05.608 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:09:05.608 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:09:05.649 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:09:05.672 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:09:05.672 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:09:05.672 INFO: Building model
2023-06-22 17:09:05.672 INFO: Hidden irreps: 96x0e
2023-06-22 17:09:07.369 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:09:07.427 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
    (1): EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (contractions_features): ModuleList(
              (0): GraphModule()
              (1): GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:09:07.429 INFO: Number of parameters: 386032
2023-06-22 17:09:07.429 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:09:07.429 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:09:07.429 INFO: Started training
2023-06-22 17:09:17.495 INFO: Epoch 0: loss=7.3148, RMSE_E_per_atom=318.0 meV, RMSE_F=849.3 meV / A
2023-06-22 17:09:21.978 INFO: Epoch 2: loss=2.8547, RMSE_E_per_atom=337.9 meV, RMSE_F=523.5 meV / A
2023-06-22 17:09:24.523 INFO: Epoch 4: loss=1.9850, RMSE_E_per_atom=293.2 meV, RMSE_F=435.8 meV / A
2023-06-22 17:09:27.057 INFO: Epoch 6: loss=1.6659, RMSE_E_per_atom=249.1 meV, RMSE_F=400.5 meV / A
2023-06-22 17:09:29.587 INFO: Epoch 8: loss=1.5455, RMSE_E_per_atom=247.1 meV, RMSE_F=385.3 meV / A
2023-06-22 17:09:32.101 INFO: Epoch 10: loss=1.0362, RMSE_E_per_atom=219.3 meV, RMSE_F=314.3 meV / A
2023-06-22 17:09:34.595 INFO: Epoch 12: loss=0.9756, RMSE_E_per_atom=235.9 meV, RMSE_F=303.3 meV / A
2023-06-22 17:09:37.078 INFO: Epoch 14: loss=0.9923, RMSE_E_per_atom=221.9 meV, RMSE_F=307.1 meV / A
2023-06-22 17:09:39.496 INFO: Epoch 16: loss=1.0111, RMSE_E_per_atom=207.2 meV, RMSE_F=311.1 meV / A
2023-06-22 17:09:41.894 INFO: Epoch 18: loss=0.7586, RMSE_E_per_atom=213.1 meV, RMSE_F=267.1 meV / A
2023-06-22 17:09:44.329 INFO: Epoch 20: loss=0.6770, RMSE_E_per_atom=174.7 meV, RMSE_F=254.3 meV / A
2023-06-22 17:09:46.759 INFO: Epoch 22: loss=0.7610, RMSE_E_per_atom=184.8 meV, RMSE_F=269.6 meV / A
2023-06-22 17:09:49.168 INFO: Epoch 24: loss=0.5090, RMSE_E_per_atom=187.4 meV, RMSE_F=217.7 meV / A
2023-06-22 17:09:51.612 INFO: Epoch 26: loss=0.6163, RMSE_E_per_atom=181.4 meV, RMSE_F=241.5 meV / A
2023-06-22 17:09:54.001 INFO: Epoch 28: loss=0.6340, RMSE_E_per_atom=159.0 meV, RMSE_F=246.7 meV / A
2023-06-22 17:09:56.447 INFO: Epoch 30: loss=0.5848, RMSE_E_per_atom=146.9 meV, RMSE_F=237.3 meV / A
2023-06-22 17:09:58.863 INFO: Epoch 32: loss=0.6076, RMSE_E_per_atom=164.8 meV, RMSE_F=240.9 meV / A
2023-06-22 17:10:01.259 INFO: Epoch 34: loss=0.3705, RMSE_E_per_atom=160.0 meV, RMSE_F=185.7 meV / A
2023-06-22 17:10:03.715 INFO: Epoch 36: loss=0.3762, RMSE_E_per_atom=151.0 meV, RMSE_F=188.0 meV / A
2023-06-22 17:10:06.149 INFO: Epoch 38: loss=0.4469, RMSE_E_per_atom=148.5 meV, RMSE_F=206.1 meV / A
2023-06-22 17:10:08.560 INFO: Epoch 40: loss=0.4004, RMSE_E_per_atom=159.7 meV, RMSE_F=193.6 meV / A
2023-06-22 17:10:10.974 INFO: Epoch 42: loss=0.3806, RMSE_E_per_atom=148.5 meV, RMSE_F=189.3 meV / A
2023-06-22 17:10:13.377 INFO: Epoch 44: loss=0.3940, RMSE_E_per_atom=155.5 meV, RMSE_F=192.3 meV / A
2023-06-22 17:10:15.790 INFO: Epoch 46: loss=0.3312, RMSE_E_per_atom=134.8 meV, RMSE_F=176.9 meV / A
2023-06-22 17:10:18.226 INFO: Epoch 48: loss=0.3715, RMSE_E_per_atom=167.8 meV, RMSE_F=185.3 meV / A
2023-06-22 17:10:20.658 INFO: Epoch 50: loss=0.3726, RMSE_E_per_atom=142.1 meV, RMSE_F=187.7 meV / A
2023-06-22 17:10:23.066 INFO: Epoch 52: loss=0.3280, RMSE_E_per_atom=130.3 meV, RMSE_F=176.4 meV / A
2023-06-22 17:10:25.524 INFO: Epoch 54: loss=0.3626, RMSE_E_per_atom=119.9 meV, RMSE_F=186.6 meV / A
2023-06-22 17:10:27.967 INFO: Epoch 56: loss=0.3359, RMSE_E_per_atom=112.6 meV, RMSE_F=179.8 meV / A
2023-06-22 17:10:30.386 INFO: Epoch 58: loss=0.2895, RMSE_E_per_atom=117.1 meV, RMSE_F=166.1 meV / A
2023-06-22 17:10:32.764 INFO: Epoch 60: loss=0.3146, RMSE_E_per_atom=111.0 meV, RMSE_F=173.9 meV / A
2023-06-22 17:10:34.998 INFO: Epoch 62: loss=0.4358, RMSE_E_per_atom=129.5 meV, RMSE_F=204.7 meV / A
2023-06-22 17:10:37.241 INFO: Epoch 64: loss=0.3019, RMSE_E_per_atom=117.1 meV, RMSE_F=169.8 meV / A
2023-06-22 17:11:00.770 INFO: MACE version: 0.2.0
2023-06-22 17:11:00.770 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:11:00.919 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:11:01.026 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:11:01.026 INFO: Using random 10.0% of training set for validation
2023-06-22 17:11:01.028 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:11:01.028 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:11:01.028 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:11:01.029 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:11:01.243 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:11:01.303 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:11:01.304 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:11:01.304 INFO: Building model
2023-06-22 17:11:01.304 INFO: Hidden irreps: 96x0e
2023-06-22 17:11:08.510 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:11:08.580 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:11:08.585 INFO: Number of parameters: 386032
2023-06-22 17:11:08.585 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:11:08.586 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:11:08.586 INFO: Started training
2023-06-22 17:11:39.835 INFO: MACE version: 0.2.0
2023-06-22 17:11:39.835 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:11:39.978 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:11:40.029 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:11:40.029 INFO: Using random 10.0% of training set for validation
2023-06-22 17:11:40.029 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:11:40.029 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:11:40.029 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:11:40.029 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:11:40.143 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:11:40.163 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:11:40.163 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:11:40.163 INFO: Building model
2023-06-22 17:11:40.163 INFO: Hidden irreps: 96x0e
2023-06-22 17:11:42.089 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:11:42.152 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:11:42.154 INFO: Number of parameters: 386032
2023-06-22 17:11:42.154 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:11:42.154 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:11:42.154 INFO: Started training
2023-06-22 17:14:23.258 INFO: MACE version: 0.2.0
2023-06-22 17:14:23.258 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:14:23.402 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:14:23.453 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:14:23.453 INFO: Using random 10.0% of training set for validation
2023-06-22 17:14:23.454 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:14:23.454 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:14:23.454 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:14:23.454 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:14:23.568 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:14:23.589 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:14:23.589 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:14:23.589 INFO: Building model
2023-06-22 17:14:23.589 INFO: Hidden irreps: 96x0e
2023-06-22 17:14:25.528 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:14:25.590 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:14:25.592 INFO: Number of parameters: 386032
2023-06-22 17:14:25.592 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:14:25.592 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:14:25.592 INFO: Started training
2023-06-22 17:17:33.881 INFO: MACE version: 0.2.0
2023-06-22 17:17:33.882 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:17:34.039 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:17:34.089 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:17:34.089 INFO: Using random 10.0% of training set for validation
2023-06-22 17:17:34.089 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:17:34.089 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:17:34.090 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:17:34.090 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:17:34.191 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:17:34.211 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:17:34.211 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:17:34.211 INFO: Building model
2023-06-22 17:17:34.211 INFO: Hidden irreps: 96x0e
2023-06-22 17:17:36.113 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:17:36.175 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:17:36.176 INFO: Number of parameters: 386032
2023-06-22 17:17:36.177 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:17:36.177 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:17:36.177 INFO: Started training
2023-06-22 17:19:22.368 INFO: MACE version: 0.2.0
2023-06-22 17:19:22.368 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:19:22.498 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:19:22.550 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:19:22.550 INFO: Using random 10.0% of training set for validation
2023-06-22 17:19:22.550 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:19:22.550 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:19:22.550 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:19:22.551 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:19:22.652 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:19:22.672 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:19:22.672 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:19:22.672 INFO: Building model
2023-06-22 17:19:22.672 INFO: Hidden irreps: 96x0e
2023-06-22 17:19:24.571 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:19:24.633 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:19:24.635 INFO: Number of parameters: 386032
2023-06-22 17:19:24.635 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:19:24.635 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:19:24.636 INFO: Started training
2023-06-22 17:19:51.575 INFO: MACE version: 0.2.0
2023-06-22 17:19:51.575 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:19:51.703 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:19:51.748 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:19:51.748 INFO: Using random 10.0% of training set for validation
2023-06-22 17:19:51.748 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:19:51.749 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:19:51.749 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:19:51.749 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:19:51.851 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:19:51.870 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:19:51.870 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:19:51.871 INFO: Building model
2023-06-22 17:19:51.871 INFO: Hidden irreps: 96x0e
2023-06-22 17:19:53.768 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:19:53.831 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:19:53.833 INFO: Number of parameters: 386032
2023-06-22 17:19:53.833 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:19:53.833 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:19:53.833 INFO: Started training
2023-06-22 17:21:56.111 INFO: MACE version: 0.2.0
2023-06-22 17:21:56.111 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:21:56.238 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:21:56.291 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:21:56.291 INFO: Using random 10.0% of training set for validation
2023-06-22 17:21:56.291 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:21:56.291 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:21:56.292 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:21:56.292 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:21:56.393 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:21:56.413 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:21:56.413 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:21:56.413 INFO: Building model
2023-06-22 17:21:56.413 INFO: Hidden irreps: 96x0e
2023-06-22 17:21:58.327 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:21:58.390 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:21:58.392 INFO: Number of parameters: 386032
2023-06-22 17:21:58.392 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:21:58.392 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:21:58.392 INFO: Started training
2023-06-22 17:22:49.652 INFO: MACE version: 0.2.0
2023-06-22 17:22:49.652 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:22:49.779 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:22:49.825 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:22:49.825 INFO: Using random 10.0% of training set for validation
2023-06-22 17:22:49.825 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:22:49.825 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:22:49.825 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:22:49.826 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:22:49.938 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:22:49.958 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:22:49.958 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:22:49.959 INFO: Building model
2023-06-22 17:22:49.959 INFO: Hidden irreps: 96x0e
2023-06-22 17:22:51.868 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:22:51.931 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:22:51.933 INFO: Number of parameters: 386032
2023-06-22 17:22:51.933 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:22:51.933 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:22:51.933 INFO: Started training
2023-06-22 17:23:37.494 INFO: MACE version: 0.2.0
2023-06-22 17:23:37.494 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:23:37.635 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:23:37.685 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:23:37.685 INFO: Using random 10.0% of training set for validation
2023-06-22 17:23:37.685 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:23:37.686 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:23:37.686 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:23:37.686 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:23:37.800 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:23:37.820 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:23:37.820 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:23:37.820 INFO: Building model
2023-06-22 17:23:37.820 INFO: Hidden irreps: 96x0e
2023-06-22 17:23:39.728 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:23:39.791 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:23:39.793 INFO: Number of parameters: 386032
2023-06-22 17:23:39.793 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:23:39.793 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:23:39.793 INFO: Started training
2023-06-22 17:27:18.811 INFO: MACE version: 0.2.0
2023-06-22 17:27:18.811 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:27:18.954 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:27:19.006 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:27:19.006 INFO: Using random 10.0% of training set for validation
2023-06-22 17:27:19.006 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:27:19.006 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:27:19.006 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:27:19.006 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:27:19.107 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:27:19.128 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:27:19.128 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:27:19.128 INFO: Building model
2023-06-22 17:27:19.128 INFO: Hidden irreps: 96x0e
2023-06-22 17:27:21.044 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:27:21.107 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:27:21.109 INFO: Number of parameters: 386032
2023-06-22 17:27:21.109 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:27:21.110 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:27:21.110 INFO: Started training
2023-06-22 17:27:36.699 INFO: MACE version: 0.2.0
2023-06-22 17:27:36.699 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:27:36.841 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:27:36.886 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:27:36.886 INFO: Using random 10.0% of training set for validation
2023-06-22 17:27:36.887 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:27:36.887 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:27:36.887 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:27:36.887 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:27:36.988 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:27:37.008 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:27:37.009 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:27:37.009 INFO: Building model
2023-06-22 17:27:37.009 INFO: Hidden irreps: 96x0e
2023-06-22 17:27:38.930 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:27:38.992 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:27:38.994 INFO: Number of parameters: 386032
2023-06-22 17:27:38.994 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:27:38.994 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:27:38.994 INFO: Started training
2023-06-22 17:28:33.584 INFO: MACE version: 0.2.0
2023-06-22 17:28:33.584 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:28:33.724 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:28:33.773 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:28:33.774 INFO: Using random 10.0% of training set for validation
2023-06-22 17:28:33.774 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:28:33.774 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:28:33.774 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:28:33.774 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:28:33.874 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:28:33.894 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:28:33.894 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:28:33.894 INFO: Building model
2023-06-22 17:28:33.894 INFO: Hidden irreps: 96x0e
2023-06-22 17:28:35.795 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:28:35.858 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:28:35.860 INFO: Number of parameters: 386032
2023-06-22 17:28:35.860 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:28:35.860 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:28:35.860 INFO: Started training
2023-06-22 17:29:04.827 INFO: MACE version: 0.2.0
2023-06-22 17:29:04.828 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:29:04.969 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:29:05.014 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:29:05.014 INFO: Using random 10.0% of training set for validation
2023-06-22 17:29:05.014 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:29:05.014 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:29:05.014 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:29:05.014 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:29:05.115 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:29:05.135 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:29:05.135 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:29:05.135 INFO: Building model
2023-06-22 17:29:05.135 INFO: Hidden irreps: 96x0e
2023-06-22 17:29:07.037 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:29:07.100 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:29:07.101 INFO: Number of parameters: 386032
2023-06-22 17:29:07.101 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:29:07.102 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:29:07.102 INFO: Started training
2023-06-22 17:29:41.181 INFO: Epoch 0: loss=7.6390, RMSE_E_per_atom=267.8 meV, RMSE_F=869.9 meV / A
2023-06-22 17:30:30.603 INFO: Epoch 2: loss=3.0219, RMSE_E_per_atom=295.3 meV, RMSE_F=541.7 meV / A
2023-06-22 17:31:15.971 INFO: Epoch 4: loss=1.8461, RMSE_E_per_atom=272.1 meV, RMSE_F=421.0 meV / A
2023-06-22 17:32:01.169 INFO: Epoch 6: loss=2.0769, RMSE_E_per_atom=220.7 meV, RMSE_F=450.3 meV / A
2023-06-22 17:32:46.331 INFO: Epoch 8: loss=1.6336, RMSE_E_per_atom=216.8 meV, RMSE_F=398.3 meV / A
2023-06-22 17:33:31.995 INFO: Epoch 10: loss=1.3635, RMSE_E_per_atom=201.1 meV, RMSE_F=363.7 meV / A
2023-06-22 17:34:17.713 INFO: Epoch 12: loss=1.3042, RMSE_E_per_atom=219.7 meV, RMSE_F=354.4 meV / A
2023-06-22 17:35:03.284 INFO: Epoch 14: loss=1.1721, RMSE_E_per_atom=199.0 meV, RMSE_F=336.5 meV / A
2023-06-22 17:35:49.044 INFO: Epoch 16: loss=1.3024, RMSE_E_per_atom=204.6 meV, RMSE_F=355.0 meV / A
2023-06-22 17:36:34.768 INFO: Epoch 18: loss=1.1097, RMSE_E_per_atom=195.2 meV, RMSE_F=327.4 meV / A
2023-06-22 17:37:19.954 INFO: Epoch 20: loss=0.9360, RMSE_E_per_atom=177.9 meV, RMSE_F=300.7 meV / A
2023-06-22 17:38:05.573 INFO: Epoch 22: loss=1.1167, RMSE_E_per_atom=173.3 meV, RMSE_F=329.6 meV / A
2023-06-22 17:38:33.087 INFO: MACE version: 0.2.0
2023-06-22 17:38:33.087 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:38:33.228 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:38:33.279 INFO: Loaded 76 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_neutral_subset.xyz'
2023-06-22 17:38:33.280 INFO: Using random 10.0% of training set for validation
2023-06-22 17:38:33.280 INFO: Total number of configurations: train=69, valid=7, tests=[]
2023-06-22 17:38:33.280 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:38:33.280 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:38:33.280 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:38:33.394 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:38:33.414 INFO: Average number of neighbors: 14.907216494845361
2023-06-22 17:38:33.414 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:38:33.414 INFO: Building model
2023-06-22 17:38:33.414 INFO: Hidden irreps: 96x0e
2023-06-22 17:38:35.328 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:38:35.390 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.061566, shift=-5.693125)
)
2023-06-22 17:38:35.392 INFO: Number of parameters: 386032
2023-06-22 17:38:35.392 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:38:35.392 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:38:35.392 INFO: Started training
2023-06-22 17:38:46.620 INFO: Epoch 0: loss=7.3148, RMSE_E_per_atom=318.0 meV, RMSE_F=849.3 meV / A
2023-06-22 17:38:51.255 INFO: Epoch 2: loss=2.8547, RMSE_E_per_atom=337.9 meV, RMSE_F=523.5 meV / A
2023-06-22 17:38:53.878 INFO: Epoch 4: loss=1.9850, RMSE_E_per_atom=293.2 meV, RMSE_F=435.8 meV / A
2023-06-22 17:38:56.465 INFO: Epoch 6: loss=1.6659, RMSE_E_per_atom=249.1 meV, RMSE_F=400.5 meV / A
2023-06-22 17:38:59.066 INFO: Epoch 8: loss=1.5455, RMSE_E_per_atom=247.1 meV, RMSE_F=385.3 meV / A
2023-06-22 17:39:01.639 INFO: Epoch 10: loss=1.0362, RMSE_E_per_atom=219.3 meV, RMSE_F=314.3 meV / A
2023-06-22 17:39:04.177 INFO: Epoch 12: loss=0.9756, RMSE_E_per_atom=235.9 meV, RMSE_F=303.3 meV / A
2023-06-22 17:39:06.749 INFO: Epoch 14: loss=0.9923, RMSE_E_per_atom=221.9 meV, RMSE_F=307.1 meV / A
2023-06-22 17:39:09.272 INFO: Epoch 16: loss=1.0111, RMSE_E_per_atom=207.2 meV, RMSE_F=311.1 meV / A
2023-06-22 17:39:11.768 INFO: Epoch 18: loss=0.7586, RMSE_E_per_atom=213.1 meV, RMSE_F=267.1 meV / A
2023-06-22 17:39:14.300 INFO: Epoch 20: loss=0.6770, RMSE_E_per_atom=174.7 meV, RMSE_F=254.3 meV / A
2023-06-22 17:39:16.854 INFO: Epoch 22: loss=0.7610, RMSE_E_per_atom=184.8 meV, RMSE_F=269.6 meV / A
2023-06-22 17:39:19.382 INFO: Epoch 24: loss=0.5090, RMSE_E_per_atom=187.4 meV, RMSE_F=217.7 meV / A
2023-06-22 17:39:21.938 INFO: Epoch 26: loss=0.6163, RMSE_E_per_atom=181.4 meV, RMSE_F=241.5 meV / A
2023-06-22 17:39:24.438 INFO: Epoch 28: loss=0.6340, RMSE_E_per_atom=159.0 meV, RMSE_F=246.7 meV / A
2023-06-22 17:39:26.955 INFO: Epoch 30: loss=0.5848, RMSE_E_per_atom=146.9 meV, RMSE_F=237.3 meV / A
2023-06-22 17:39:29.480 INFO: Epoch 32: loss=0.6076, RMSE_E_per_atom=164.8 meV, RMSE_F=240.9 meV / A
2023-06-22 17:39:31.985 INFO: Epoch 34: loss=0.3705, RMSE_E_per_atom=160.0 meV, RMSE_F=185.7 meV / A
2023-06-22 17:39:34.579 INFO: Epoch 36: loss=0.3762, RMSE_E_per_atom=151.0 meV, RMSE_F=188.0 meV / A
2023-06-22 17:39:37.124 INFO: Epoch 38: loss=0.4469, RMSE_E_per_atom=148.5 meV, RMSE_F=206.1 meV / A
2023-06-22 17:39:39.641 INFO: Epoch 40: loss=0.4004, RMSE_E_per_atom=159.7 meV, RMSE_F=193.6 meV / A
2023-06-22 17:39:42.151 INFO: Epoch 42: loss=0.3806, RMSE_E_per_atom=148.5 meV, RMSE_F=189.3 meV / A
2023-06-22 17:39:44.657 INFO: Epoch 44: loss=0.3940, RMSE_E_per_atom=155.5 meV, RMSE_F=192.3 meV / A
2023-06-22 17:39:47.172 INFO: Epoch 46: loss=0.3312, RMSE_E_per_atom=134.8 meV, RMSE_F=176.9 meV / A
2023-06-22 17:39:49.724 INFO: Epoch 48: loss=0.3715, RMSE_E_per_atom=167.8 meV, RMSE_F=185.3 meV / A
2023-06-22 17:39:52.254 INFO: Epoch 50: loss=0.3726, RMSE_E_per_atom=142.1 meV, RMSE_F=187.7 meV / A
2023-06-22 17:39:54.767 INFO: Epoch 52: loss=0.3280, RMSE_E_per_atom=130.3 meV, RMSE_F=176.4 meV / A
2023-06-22 17:39:57.340 INFO: Epoch 54: loss=0.3626, RMSE_E_per_atom=119.9 meV, RMSE_F=186.6 meV / A
2023-06-22 17:39:59.894 INFO: Epoch 56: loss=0.3359, RMSE_E_per_atom=112.6 meV, RMSE_F=179.8 meV / A
2023-06-22 17:40:02.421 INFO: Epoch 58: loss=0.2895, RMSE_E_per_atom=117.1 meV, RMSE_F=166.1 meV / A
2023-06-22 17:40:04.987 INFO: Epoch 60: loss=0.3146, RMSE_E_per_atom=111.0 meV, RMSE_F=173.9 meV / A
2023-06-22 17:42:10.302 INFO: MACE version: 0.2.0
2023-06-22 17:42:10.302 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged_subset.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=2, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:42:10.443 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:42:10.496 INFO: Loaded 63 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged_subset.xyz'
2023-06-22 17:42:10.496 INFO: Using random 10.0% of training set for validation
2023-06-22 17:42:10.496 INFO: Total number of configurations: train=57, valid=6, tests=[]
2023-06-22 17:42:10.497 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:42:10.497 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:42:10.497 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:42:10.624 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:42:10.641 INFO: Average number of neighbors: 18.104147465437787
2023-06-22 17:42:10.641 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:42:10.641 INFO: Building model
2023-06-22 17:42:10.641 INFO: Hidden irreps: 96x0e
2023-06-22 17:42:12.576 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:42:12.638 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.082793, shift=-5.384122)
)
2023-06-22 17:42:12.640 INFO: Number of parameters: 386032
2023-06-22 17:42:12.640 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:42:12.640 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:42:12.640 INFO: Started training
2023-06-22 17:42:24.020 INFO: Epoch 0: loss=3.5096, RMSE_E_per_atom=78.5 meV, RMSE_F=591.9 meV / A
2023-06-22 17:42:28.342 INFO: Epoch 2: loss=1.7913, RMSE_E_per_atom=171.8 meV, RMSE_F=419.7 meV / A
2023-06-22 17:42:30.667 INFO: Epoch 4: loss=1.2798, RMSE_E_per_atom=84.7 meV, RMSE_F=356.7 meV / A
2023-06-22 17:42:32.950 INFO: Epoch 6: loss=0.8297, RMSE_E_per_atom=81.5 meV, RMSE_F=286.9 meV / A
2023-06-22 17:42:35.164 INFO: Epoch 8: loss=0.5892, RMSE_E_per_atom=46.3 meV, RMSE_F=242.3 meV / A
2023-06-22 17:42:37.466 INFO: Epoch 10: loss=0.4209, RMSE_E_per_atom=42.1 meV, RMSE_F=204.7 meV / A
2023-06-22 17:42:39.767 INFO: Epoch 12: loss=0.7381, RMSE_E_per_atom=42.6 meV, RMSE_F=271.4 meV / A
2023-06-22 17:42:42.010 INFO: Epoch 14: loss=0.3365, RMSE_E_per_atom=63.5 meV, RMSE_F=182.3 meV / A
2023-06-22 17:42:44.278 INFO: Epoch 16: loss=0.2501, RMSE_E_per_atom=78.8 meV, RMSE_F=156.2 meV / A
2023-06-22 17:42:46.549 INFO: Epoch 18: loss=0.2366, RMSE_E_per_atom=69.2 meV, RMSE_F=152.2 meV / A
2023-06-22 17:42:48.812 INFO: Epoch 20: loss=0.4539, RMSE_E_per_atom=45.5 meV, RMSE_F=212.6 meV / A
2023-06-22 17:42:51.060 INFO: Epoch 22: loss=0.2125, RMSE_E_per_atom=57.8 meV, RMSE_F=144.6 meV / A
2023-06-22 17:43:07.581 INFO: MACE version: 0.2.0
2023-06-22 17:43:07.581 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/neutral/', checkpoints_dir='experiments/neutral/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=8, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:43:07.722 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:43:08.421 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 17:43:08.422 INFO: Using random 10.0% of training set for validation
2023-06-22 17:43:08.422 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 17:43:08.431 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:43:08.431 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:43:08.431 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:43:28.303 INFO: MACE version: 0.2.0
2023-06-22 17:43:28.303 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/charged/', checkpoints_dir='experiments/charged/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=8, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 17:43:28.440 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 17:43:29.131 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 17:43:29.131 INFO: Using random 10.0% of training set for validation
2023-06-22 17:43:29.132 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 17:43:29.141 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 17:43:29.141 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 17:43:29.141 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 17:43:34.056 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 17:43:34.341 INFO: Average number of neighbors: 18.828756864702946
2023-06-22 17:43:34.342 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 17:43:34.342 INFO: Building model
2023-06-22 17:43:34.342 INFO: Hidden irreps: 96x0e
2023-06-22 17:43:36.454 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 17:43:36.516 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244502, shift=-5.372109)
)
2023-06-22 17:43:36.517 INFO: Number of parameters: 386032
2023-06-22 17:43:36.518 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 17:43:36.518 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 17:43:36.518 INFO: Started training
2023-06-22 17:43:59.752 INFO: Epoch 0: loss=1.8928, RMSE_E_per_atom=508.7 meV, RMSE_F=398.0 meV / A
2023-06-22 17:44:22.106 INFO: Epoch 2: loss=0.6153, RMSE_E_per_atom=284.5 meV, RMSE_F=231.9 meV / A
2023-06-22 17:44:44.423 INFO: Epoch 4: loss=0.5067, RMSE_E_per_atom=228.4 meV, RMSE_F=211.2 meV / A
2023-06-22 17:45:07.090 INFO: Epoch 6: loss=0.3997, RMSE_E_per_atom=161.5 meV, RMSE_F=193.0 meV / A
2023-06-22 17:45:29.854 INFO: Epoch 8: loss=0.2980, RMSE_E_per_atom=145.3 meV, RMSE_F=166.3 meV / A
2023-06-22 17:45:52.602 INFO: Epoch 10: loss=0.3743, RMSE_E_per_atom=135.3 meV, RMSE_F=186.8 meV / A
2023-06-22 17:46:15.547 INFO: Epoch 12: loss=0.1783, RMSE_E_per_atom=118.2 meV, RMSE_F=128.7 meV / A
2023-06-22 17:46:38.530 INFO: Epoch 14: loss=0.1849, RMSE_E_per_atom=114.9 meV, RMSE_F=131.1 meV / A
2023-06-22 17:47:01.572 INFO: Epoch 16: loss=0.1847, RMSE_E_per_atom=104.4 meV, RMSE_F=132.5 meV / A
2023-06-22 17:47:24.613 INFO: Epoch 18: loss=0.2554, RMSE_E_per_atom=108.7 meV, RMSE_F=158.3 meV / A
2023-06-22 17:47:47.822 INFO: Epoch 20: loss=0.1512, RMSE_E_per_atom=102.4 meV, RMSE_F=118.4 meV / A
2023-06-22 17:48:10.993 INFO: Epoch 22: loss=0.1315, RMSE_E_per_atom=95.9 meV, RMSE_F=110.3 meV / A
2023-06-22 17:48:33.005 INFO: Epoch 24: loss=0.1484, RMSE_E_per_atom=96.5 meV, RMSE_F=117.2 meV / A
2023-06-22 17:48:54.997 INFO: Epoch 26: loss=0.1172, RMSE_E_per_atom=92.1 meV, RMSE_F=103.5 meV / A
2023-06-22 17:49:17.115 INFO: Epoch 28: loss=0.1303, RMSE_E_per_atom=88.7 meV, RMSE_F=110.8 meV / A
2023-06-22 17:49:39.185 INFO: Epoch 30: loss=0.1240, RMSE_E_per_atom=88.7 meV, RMSE_F=108.2 meV / A
2023-06-22 17:50:01.421 INFO: Epoch 32: loss=0.1288, RMSE_E_per_atom=90.4 meV, RMSE_F=110.3 meV / A
2023-06-22 17:50:23.665 INFO: Epoch 34: loss=0.1229, RMSE_E_per_atom=84.4 meV, RMSE_F=108.0 meV / A
2023-06-22 18:44:46.145 INFO: MACE version: 0.2.0
2023-06-22 18:44:46.145 INFO: Configuration: Namespace(name='SPICE_clmb_neutral', seed=123, log_dir='logs', model_dir='experiments/charged_no_clmb/', checkpoints_dir='experiments/charged_no_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=8, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 18:44:46.286 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 18:44:47.113 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 18:44:47.113 INFO: Using random 10.0% of training set for validation
2023-06-22 18:44:47.115 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 18:44:47.125 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 18:44:47.125 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 18:44:47.125 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 18:44:52.165 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 18:44:52.501 INFO: Average number of neighbors: 18.828756864702946
2023-06-22 18:44:52.501 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 18:44:52.501 INFO: Building model
2023-06-22 18:44:52.501 INFO: Hidden irreps: 96x0e
2023-06-22 18:44:58.443 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 18:44:58.512 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244502, shift=-5.372109)
)
2023-06-22 18:44:58.518 INFO: Number of parameters: 386032
2023-06-22 18:44:58.518 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 18:44:58.518 INFO: Using Weights and Biases for logging
2023-06-22 18:45:05.995 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 18:45:05.996 INFO: Started training
2023-06-22 18:45:30.440 INFO: Epoch 0: loss=1.8928, RMSE_E_per_atom=508.7 meV, RMSE_F=398.0 meV / A
2023-06-22 18:45:53.334 INFO: Epoch 2: loss=0.6153, RMSE_E_per_atom=284.5 meV, RMSE_F=231.9 meV / A
2023-06-22 18:46:16.173 INFO: Epoch 4: loss=0.5067, RMSE_E_per_atom=228.4 meV, RMSE_F=211.2 meV / A
2023-06-22 18:46:38.974 INFO: Epoch 6: loss=0.3997, RMSE_E_per_atom=161.5 meV, RMSE_F=193.0 meV / A
2023-06-22 18:47:00.399 INFO: Epoch 8: loss=0.2980, RMSE_E_per_atom=145.3 meV, RMSE_F=166.3 meV / A
2023-06-22 18:47:21.672 INFO: Epoch 10: loss=0.3743, RMSE_E_per_atom=135.3 meV, RMSE_F=186.8 meV / A
2023-06-22 18:47:42.996 INFO: Epoch 12: loss=0.1783, RMSE_E_per_atom=118.2 meV, RMSE_F=128.7 meV / A
2023-06-22 18:48:04.361 INFO: Epoch 14: loss=0.1849, RMSE_E_per_atom=114.9 meV, RMSE_F=131.1 meV / A
2023-06-22 18:48:25.921 INFO: Epoch 16: loss=0.1847, RMSE_E_per_atom=104.4 meV, RMSE_F=132.5 meV / A
2023-06-22 18:48:47.432 INFO: Epoch 18: loss=0.2554, RMSE_E_per_atom=108.7 meV, RMSE_F=158.3 meV / A
2023-06-22 18:49:09.101 INFO: Epoch 20: loss=0.1512, RMSE_E_per_atom=102.4 meV, RMSE_F=118.4 meV / A
2023-06-22 18:49:31.803 INFO: Epoch 22: loss=0.1315, RMSE_E_per_atom=95.9 meV, RMSE_F=110.3 meV / A
2023-06-22 18:49:55.264 INFO: Epoch 24: loss=0.1484, RMSE_E_per_atom=96.5 meV, RMSE_F=117.2 meV / A
2023-06-22 18:50:17.305 INFO: Epoch 26: loss=0.1172, RMSE_E_per_atom=92.1 meV, RMSE_F=103.5 meV / A
2023-06-22 18:50:39.198 INFO: Epoch 28: loss=0.1303, RMSE_E_per_atom=88.7 meV, RMSE_F=110.8 meV / A
