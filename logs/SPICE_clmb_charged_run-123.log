2023-06-22 18:54:32.080 INFO: MACE version: 0.2.0
2023-06-22 18:54:32.081 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=8, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 18:54:32.195 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 18:54:32.884 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 18:54:32.885 INFO: Using random 10.0% of training set for validation
2023-06-22 18:54:32.885 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 18:54:32.894 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 18:54:32.894 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 18:54:32.894 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 18:54:37.836 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 18:54:38.129 INFO: Average number of neighbors: 18.828756864702946
2023-06-22 18:54:38.130 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 18:54:38.130 INFO: Building model
2023-06-22 18:54:38.130 INFO: Hidden irreps: 96x0e
2023-06-22 18:54:40.249 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 18:54:40.311 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244502, shift=-5.372109)
)
2023-06-22 18:54:40.313 INFO: Number of parameters: 386032
2023-06-22 18:54:40.313 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 18:54:40.314 INFO: Using Weights and Biases for logging
2023-06-22 18:54:44.929 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 18:54:44.929 INFO: Started training
2023-06-22 19:08:34.669 INFO: MACE version: 0.2.0
2023-06-22 19:08:34.669 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=8, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=True, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:08:34.783 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:08:35.481 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:08:35.482 INFO: Using random 10.0% of training set for validation
2023-06-22 19:08:35.483 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:08:35.491 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:08:35.491 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:08:35.492 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:08:40.419 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:08:40.713 INFO: Average number of neighbors: 18.828756864702946
2023-06-22 19:08:40.713 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:08:40.713 INFO: Building model
2023-06-22 19:08:40.713 INFO: Hidden irreps: 96x0e
2023-06-22 19:08:42.827 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:08:42.889 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244502, shift=-5.372109)
)
2023-06-22 19:08:42.891 INFO: Number of parameters: 386032
2023-06-22 19:08:42.891 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:08:42.891 INFO: Using Weights and Biases for logging
2023-06-22 19:08:47.580 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:08:47.580 INFO: Started training
2023-06-22 19:12:06.027 INFO: MACE version: 0.2.0
2023-06-22 19:12:06.027 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=8, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:12:06.141 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:12:06.837 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:12:06.838 INFO: Using random 10.0% of training set for validation
2023-06-22 19:12:06.838 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:12:06.847 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:12:06.847 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:12:06.847 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:12:11.887 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:12:12.173 INFO: Average number of neighbors: 18.828756864702946
2023-06-22 19:12:12.173 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:12:12.173 INFO: Building model
2023-06-22 19:12:12.173 INFO: Hidden irreps: 96x0e
2023-06-22 19:12:14.275 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:12:14.340 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244502, shift=-5.372109)
)
2023-06-22 19:12:14.342 INFO: Number of parameters: 386032
2023-06-22 19:12:14.343 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:12:14.343 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:12:14.343 INFO: Started training
2023-06-22 19:22:06.593 INFO: MACE version: 0.2.0
2023-06-22 19:22:06.593 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:22:06.692 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:22:07.380 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:22:07.381 INFO: Using random 10.0% of training set for validation
2023-06-22 19:22:07.381 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:22:07.390 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:22:07.390 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:22:07.390 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:22:12.320 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:22:12.535 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:22:12.535 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:22:12.536 INFO: Building model
2023-06-22 19:22:12.536 INFO: Hidden irreps: 96x0e
2023-06-22 19:22:14.553 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:22:14.615 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:22:14.617 INFO: Number of parameters: 386032
2023-06-22 19:22:14.617 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:22:14.617 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:22:14.617 INFO: Started training
2023-06-22 19:24:59.830 INFO: MACE version: 0.2.0
2023-06-22 19:24:59.830 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:24:59.932 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:25:00.633 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:25:00.634 INFO: Using random 10.0% of training set for validation
2023-06-22 19:25:00.634 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:25:00.643 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:25:00.643 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:25:00.644 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:25:05.583 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:25:05.798 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:25:05.798 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:25:05.798 INFO: Building model
2023-06-22 19:25:05.798 INFO: Hidden irreps: 96x0e
2023-06-22 19:25:07.837 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:25:07.899 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:25:07.900 INFO: Number of parameters: 386032
2023-06-22 19:25:07.900 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:25:07.901 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:25:07.901 INFO: Started training
2023-06-22 19:29:23.283 INFO: MACE version: 0.2.0
2023-06-22 19:29:23.284 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:29:23.387 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:29:24.083 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:29:24.084 INFO: Using random 10.0% of training set for validation
2023-06-22 19:29:24.084 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:29:24.093 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:29:24.093 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:29:24.093 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:29:29.049 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:29:29.263 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:29:29.263 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:29:29.263 INFO: Building model
2023-06-22 19:29:29.263 INFO: Hidden irreps: 96x0e
2023-06-22 19:29:31.362 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:29:31.429 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:29:31.432 INFO: Number of parameters: 386032
2023-06-22 19:29:31.432 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:29:31.432 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:29:31.432 INFO: Started training
2023-06-22 19:31:00.196 INFO: MACE version: 0.2.0
2023-06-22 19:31:00.196 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:31:00.297 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:31:00.987 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:31:00.987 INFO: Using random 10.0% of training set for validation
2023-06-22 19:31:00.988 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:31:00.997 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:31:00.997 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:31:00.997 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:31:05.958 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:31:06.171 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:31:06.171 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:31:06.171 INFO: Building model
2023-06-22 19:31:06.171 INFO: Hidden irreps: 96x0e
2023-06-22 19:31:08.200 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:31:08.262 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:31:08.264 INFO: Number of parameters: 386032
2023-06-22 19:31:08.264 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:31:08.264 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:31:08.264 INFO: Started training
2023-06-22 19:32:11.691 INFO: MACE version: 0.2.0
2023-06-22 19:32:11.691 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:32:11.791 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:32:12.479 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:32:12.480 INFO: Using random 10.0% of training set for validation
2023-06-22 19:32:12.480 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:32:12.489 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:32:12.489 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:32:12.489 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:32:17.425 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:32:17.638 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:32:17.638 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:32:17.638 INFO: Building model
2023-06-22 19:32:17.638 INFO: Hidden irreps: 96x0e
2023-06-22 19:32:19.668 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:32:19.730 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:32:19.732 INFO: Number of parameters: 386032
2023-06-22 19:32:19.732 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:32:19.732 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:32:19.732 INFO: Started training
2023-06-22 19:34:29.344 INFO: MACE version: 0.2.0
2023-06-22 19:34:29.344 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:34:29.446 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:34:30.143 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:34:30.144 INFO: Using random 10.0% of training set for validation
2023-06-22 19:34:30.144 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:34:30.153 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:34:30.153 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:34:30.153 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:34:35.083 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:34:35.293 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:34:35.294 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:34:35.294 INFO: Building model
2023-06-22 19:34:35.294 INFO: Hidden irreps: 96x0e
2023-06-22 19:34:37.329 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:34:37.391 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:34:37.392 INFO: Number of parameters: 386032
2023-06-22 19:34:37.392 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:34:37.393 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:34:37.393 INFO: Started training
2023-06-22 19:37:15.912 INFO: MACE version: 0.2.0
2023-06-22 19:37:15.912 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:37:16.013 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:37:16.702 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:37:16.703 INFO: Using random 10.0% of training set for validation
2023-06-22 19:37:16.704 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:37:16.713 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:37:16.713 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:37:16.713 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:37:21.658 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:37:21.873 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:37:21.873 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:37:21.873 INFO: Building model
2023-06-22 19:37:21.873 INFO: Hidden irreps: 96x0e
2023-06-22 19:37:23.909 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:37:23.971 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:37:23.973 INFO: Number of parameters: 386032
2023-06-22 19:37:23.973 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:37:23.973 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:37:23.973 INFO: Started training
2023-06-22 19:40:42.819 INFO: MACE version: 0.2.0
2023-06-22 19:40:42.819 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:40:42.922 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:40:43.624 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:40:43.625 INFO: Using random 10.0% of training set for validation
2023-06-22 19:40:43.625 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:40:43.634 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:40:43.634 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:40:43.634 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:40:48.590 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:40:48.801 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:40:48.801 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:40:48.801 INFO: Building model
2023-06-22 19:40:48.801 INFO: Hidden irreps: 96x0e
2023-06-22 19:40:50.812 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:40:50.874 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:40:50.876 INFO: Number of parameters: 386032
2023-06-22 19:40:50.876 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:40:50.876 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:40:50.876 INFO: Started training
2023-06-22 19:41:45.588 INFO: MACE version: 0.2.0
2023-06-22 19:41:45.588 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:41:45.689 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:41:46.381 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:41:46.382 INFO: Using random 10.0% of training set for validation
2023-06-22 19:41:46.382 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:41:46.391 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:41:46.391 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:41:46.392 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:41:51.334 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:41:51.551 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:41:51.552 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:41:51.552 INFO: Building model
2023-06-22 19:41:51.552 INFO: Hidden irreps: 96x0e
2023-06-22 19:41:53.580 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:41:53.643 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:41:53.644 INFO: Number of parameters: 386032
2023-06-22 19:41:53.645 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:41:53.645 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:41:53.645 INFO: Started training
2023-06-22 19:44:20.916 INFO: MACE version: 0.2.0
2023-06-22 19:44:20.917 INFO: Configuration: Namespace(name='SPICE_clmb_charged', seed=123, log_dir='logs', model_dir='experiments/charged_clmb/', checkpoints_dir='experiments/charged_clmb/', results_dir='results', downloads_dir='downloads', device='cuda', default_dtype='float64', log_level='INFO', error_table='PerAtomRMSE', model='ScaleShiftMACE', r_max=4.5, num_radial_basis=16, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='96x0e', num_channels=None, max_L=None, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz', valid_file=None, valid_fraction=0.1, test_file=None, E0s='{1: -13.571964772646007, 6: -1028.9761541634377, 7: -1483.5687222127797, 8: -2041.3695192053437, 9: -2715.318528796084, 16: -10833.014939658697, 17: -12522.649269153777, 35: -70045.28385048894, 53: -8102.524593347395, 15: -9286.584051983795}', energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='initial_charges', loss='weighted', forces_weight=10.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=64, valid_batch_size=10, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=True, start_swa=None, ema=False, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='sc_mace_invariant', wandb_entity='jharrymoore', wandb_name='softcore_mace_organic_full', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-06-22 19:44:21.076 INFO: CUDA version: 11.8, CUDA device: 0
2023-06-22 19:44:21.921 INFO: Loaded 2019 training configurations from '/home/jhm72/rds/hpc-work/software/spice-dataset/downloader/SPICE_CHNO_charged.xyz'
2023-06-22 19:44:21.922 INFO: Using random 10.0% of training set for validation
2023-06-22 19:44:21.924 INFO: Total number of configurations: train=1818, valid=201, tests=[]
2023-06-22 19:44:21.933 INFO: AtomicNumberTable: (1, 6, 7, 8)
2023-06-22 19:44:21.933 INFO: Atomic Energies not in training file, using command line argument E0s
2023-06-22 19:44:21.933 INFO: Atomic energies: [-13.571964772646007, -1028.9761541634377, -1483.5687222127797, -2041.3695192053437]
2023-06-22 19:44:26.923 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=10.000)
2023-06-22 19:44:27.163 INFO: Average number of neighbors: 18.822336475292772
2023-06-22 19:44:27.163 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-06-22 19:44:27.163 INFO: Building model
2023-06-22 19:44:27.163 INFO: Hidden irreps: 96x0e
2023-06-22 19:44:33.052 INFO: Using stochastic weight averaging (after 75 epochs) with energy weight : 1000.0, forces weight : 1.0 and learning rate : 0.001
2023-06-22 19:44:33.121 INFO: ScaleShiftMACE(
  (node_embedding): LinearNodeEmbeddingBlock(
    (linear): Linear(4x0e -> 96x0e | 384 weights)
  )
  (radial_embedding): RadialEmbeddingBlock(
    (bessel_fn): BesselBasis(r_max=4.5, num_basis=16, trainable=False)
    (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
  )
  (spherical_harmonics): SphericalHarmonics()
  (atomic_energies_fn): AtomicEnergiesBlock(energies=[-13.5720, -1028.9762, -1483.5687, -2041.3695])
  (interactions): ModuleList(
    (0): RealAgnosticInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e+96x1o+96x2e+96x3o x 4x0e -> 96x0e+96x1o+96x2e+96x3o | 147456 paths | 147456 weights)
      (reshape): reshape_irreps()
    )
    (1): RealAgnosticResidualInteractionBlock(
      (linear_up): Linear(96x0e -> 96x0e | 9216 weights)
      (conv_tp): TensorProduct(96x0e x 1x0e+1x1o+1x2e+1x3o -> 96x0e+96x1o+96x2e+96x3o | 384 paths | 384 weights)
      (conv_tp_weights): FullyConnectedNet[16, 64, 64, 64, 384]
      (linear): Linear(96x0e+96x1o+96x2e+96x3o -> 96x0e+96x1o+96x2e+96x3o | 36864 weights)
      (skip_tp): FullyConnectedTensorProduct(96x0e x 4x0e -> 96x0e | 36864 paths | 36864 weights)
      (reshape): reshape_irreps()
    )
  )
  (products): ModuleList(
    (0-1): 2 x EquivariantProductBasisBlock(
      (symmetric_contractions): SymmetricContraction(
        (contractions): ModuleList(
          (0): Contraction(
            (contractions_weighting): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (contractions_features): ModuleList(
              (0-1): 2 x GraphModule()
            )
            (weights): ParameterList(
                (0): Parameter containing: [torch.float64 of size 4x4x96 (GPU 0)]
                (1): Parameter containing: [torch.float64 of size 4x1x96 (GPU 0)]
            )
            (graph_opt_main): GraphModule()
          )
        )
      )
      (linear): Linear(96x0e -> 96x0e | 9216 weights)
    )
  )
  (readouts): ModuleList(
    (0): LinearReadoutBlock(
      (linear): Linear(96x0e -> 1x0e | 96 weights)
    )
    (1): NonLinearReadoutBlock(
      (linear_1): Linear(96x0e -> 16x0e | 1536 weights)
      (non_linearity): Activation [x] (16x0e -> 16x0e)
      (linear_2): Linear(16x0e -> 1x0e | 16 weights)
    )
  )
  (scale_shift): ScaleShiftBlock(scale=1.244298, shift=-5.372459)
)
2023-06-22 19:44:33.126 INFO: Number of parameters: 386032
2023-06-22 19:44:33.127 INFO: Optimizer: Adam (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: embedding
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_decay
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    swa_lr: 0.001
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: products
    swa_lr: 0.001
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    name: readouts
    swa_lr: 0.001
    weight_decay: 0.0
)
2023-06-22 19:44:33.127 INFO: Using gradient clipping with tolerance=10.000
2023-06-22 19:44:33.127 INFO: Started training
2023-06-22 20:12:06.328 INFO: Epoch 0: loss=8.1184, RMSE_E_per_atom=634.7 meV, RMSE_F=852.7 meV / A
